<!DOCTYPE html>
<html>
    <head>
        <title>充值统计</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <link href="__CSS__/skin.css" rel="stylesheet" type="text/css">
        <link href="__CSS__/jquery-ui.css" rel="stylesheet" type="text/css">
        <style type="text/css">
        <!--body {
            margin-left: 0px;
            margin-top: 0px;
            margin-right: 0px;
            margin-bottom: 0px;
            background-color: #EEF2FB;
            font-size: 12px;
        }
        -->
        </style>
    </head>
    <body>
		<div>
			<div>
				<table class="explain">
					<thead>
					</thead>
					<tbody style="font-family:Mingliu">
						<tr>
							<td width="5%"  class="tableleft"><b>说明：</b></td>
						</tr>
						<tr>
							<td width="95%" class="tableleft">1、元宝*人数*次数</td>
						</tr>
						<tr>
							<td width="95%" class="tableleft">2、充值人数以账号计算</td>
						</tr>
					</tbody>
				</table>
			</div>
			
			<div class="topinfo">
				<div>
					<input type="button" value="选择服务器" id ="sel">
					<span>日期：</span>
					<input type="text" class="input1" id="startdate" value="{$today}"/>
					至<input type="text" class="input1" id="enddate" value="{$today}"/>
					<input type="button" value="查询" id="querybtn" style="margin-left:20px"/>
				</div>
			</div>
			
			<div style="clear:both"></div>
			
			<div class="tabitem">				
				<div>
					<table class="mytable">
						<thead id="dtatr_thead">
						</thead>
						<tbody id="dtatr_body">
						</tbody>
					</table>
				</div>
			</div>
			
			<div style="clear:both"></div>
		</div>
	
		<!-- 服务器 -->
        <div id="sform" style="display:none">
            <div class="ajaxform">
                <table width="100%" border="0" cellspacing="0" cellpadding="0" style="table-layout:fixed;">
					<tr>
						<td>
						<volist name="serverList" id="sld" key="k">
	                        <if condition="$k%5 eq 0">
	                            <br/>
	                            <br/>
	                        </if>
	                        <input type="checkbox" name="db" value='{$sld['g_id']}'  class="cbox" id="s{$k}"/>
	                        <label for="s{$k}">
	                            {$sld['g_name']}
	                        </label>
	                        <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
	                    </volist>
						</td>
					</tr>
                </table>
            </div>
        </div>
	
    <script src="__STATIC__/jquery.js" type="text/javascript">
    </script>
    <script src="__JS__/jquery-ui.js" type="text/javascript">
    </script>
    <script src="__JS__/function.js" type="text/javascript">
    </script>
	<script type="text/javascript">
	$(document).ready(function(){
		//时间插件
		$("#startdate").datepicker();
		$("#enddate").datepicker();
		
		showTitle("充值数据分析:充值对比");
		
		$("#querybtn").click(function(){
			if( validator("startdate", "enddate") ){
				var db = [];
				$('input[name=db]:checked').each(function() {
					db.push($(this).val());
				});
				if(db==''){
					alert('请选择服务器');return false;
				}
				show(db);
			}
		});
		
		//服务器选择弹出窗
		$("#sel").click(function() {
				$("#sform").dialog({
					height : 500,
					width : 700,
					buttons : {
						"确认" : function() {
							$(this).dialog("close");
						},
						"关闭" : function() {
							$(this).dialog("close");
						}
					}
				})
			});
		
	});
	function show(db) {
		$.ajax({
			type : 'POST',
			url : '{:U("RechargeContrast/getData")}',
			dataType : 'json',
			data : {
				db : db,
				startDate : $('#startdate').val(),
				endDate :	$('#enddate').val()
			},
			beforeSend : function(){
				$("#dtatr_thead").html("");
				$("#dtatr_body").html("<tr><td><img src='__IMG__/loading.gif'/></td></tr>");
			},
			success : function (data) {
				var thread = data.thread;
				var tbody = data.tbody;
				if(tbody!=''&&tbody!=null) {
					$("#dtatr_thead").html(thread);
					$("#dtatr_body").html(tbody);
                    $("#dtatr_body tr:odd").css("background-color", "#e4eefa");
				}else {
					$("#dtatr_thead").html("");
					$("#dtatr_body").html("<tr><td>没有数据！</td></tr>");
				}
			},
			error : function () {
				alert('请求失败');
			}
		});
	}
	</script>
</body>
</html>
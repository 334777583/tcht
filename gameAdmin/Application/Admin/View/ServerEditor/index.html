<!DOCTYPE html>
<html>
<head>
<title>开服设置</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="__CSS__/skin.css" rel="stylesheet" type="text/css">
<link href="__CSS__/jquery-ui.css" rel="stylesheet" type="text/css">
<style type="text/css">
<!--
body {
	margin-left: 0px;
	margin-top: 0px;
	margin-right: 0px;
	margin-bottom: 0px;
	background-color: #EEF2FB;
	font-size: 12px;
}
-->
</style>
</head>
<body>
	<div>
		<div>
			<div>
				<table class="explain">
					<thead>
					</thead>
					<tbody style="font-family: Mingliu">
						<tr>
							<td width="5%" class="tableleft">
								<b>说明：</b>
							</td>
						</tr>
						<tr>
							<td width="95%" class="tableleft">1、此页面用于GM服务器配置</td>
						</tr>
						<tr>
							<td width="95%" class="tableleft">1、配置优先域名，如果域名不存在，务必留空</td>
						</tr>
					</tbody>
				</table>
			</div>
			<div style="float: right; margin-top: 10px;">
				<!--<img src="<{$res}>/images/add-btn2.png" style="cursor: pointer;" id="addbtn"/>-->
			</div>
			<div style="clear: both;"></div>
			<div>
				<table class="mytable" cellspacing="0" align="center">
					<thead>
						<tr>
							<th>游戏服ID</th>
							<th>服务器IP</th>
							<th>域名</th>
							<th>端口</th>
							<th>名称</th>
							<th>更新时间</th>
							<th>操作</th>
						</tr>
					</thead>
					<tbody>
						<volist name="serverList" id="sl">
						<tr id="{$sl['s_id']}">
							<td>{$sl['s_id']}</td>
							<td>{$sl['s_ip']}</td>
							<td>{$sl['s_domain']}</td>
							<td>{$sl['s_port']}</td>
							<td>{$sl['s_name']}</td>
							<td>{$sl['s_inserttime']}</td>
							<td>
								<label class="editicon"></label>
								<span class="editbtn">编辑</span>
								<label class="deleteicon"></label>
								<span class="deletebtn">删除</span>
							</td>
						</tr>
						</volist>
					</tbody>
				</table>
			</div>
		</div>

		<div id="form" style="display: none">
			<div class="ajaxform">
				<table width="80%" border="0" cellspacing="0" cellpadding="0"
					style="table-layout: fixed;">
					<tbody>
						<tr>
							<td align="right">名称：</td>
							<td>
								<input type="text" class="input-1" id="name">
							</td>
						</tr>
						<tr>
							<td align="right">域名：</td>
							<td>
								<input type="text" class="input-1" id="domain">
							</td>
						</tr>
						<tr>
							<td align="right">服务器IP：</td>
							<td>
								<input type="text" class="input-1" id="ip">
							</td>
						</tr>
						<tr>
							<td align="right">游戏服ID：</td>
							<td>
								<input type="text" class="input-1" id="sid">
							</td>
						</tr>
						<tr>
							<td align="right">端口</td>
							<td>
								<input type="text" class="input-1" id="port">
							</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>


	</div>
	<script src="__STATIC__/jquery.js" type="text/javascript">
		
	</script>
	<script src="__JS__/jquery-ui.js" type="text/javascript">
		
	</script>
	<script src="__JS__/function.js" type="text/javascript">
		
	</script>
	<script type="text/javascript">
		$(function() {
			//table单双行交叉样式
			$(".mytable tr:odd").css("background-color", "#edf2f7");
			$(".mytable tr:even").css("background-color", "#e0f0f0");

			showTitle("GM工具:GM设置");

			//编辑
			$(".editbtn").live("click", function() {
				var dom = $(this);
				var sid = dom.parents('tr').attr("id");
				$.get('{:U("ServerEditor/getById")}', {
					sid : sid
				}, function(data) {
					if (data.status) {
						$("#name").val(data['list']["s_name"]);
						$("#ip").val(data['list']["s_ip"]);
						$("#port").val(data['list']["s_port"]);
						$("#domain").val(data['list']["s_domain"]);
						$("#sid").val(data['list']["s_sid"]);
						$("#form").dialog({
							height : 300,
							width : 400,
							buttons : {
								'保存' : function() {
									$.post('{:U("ServerEditor/dbEditor")}', {
										sid : sid,
										name : $("#name").val(),
										ip : $("#ip").val(),
										port : $("#port").val(),
										domain : $("#domain").val(),
										gid : $("#sid").val()
									}, function(data) {
										alert(data.info);
										if (data.status) {
											window.location.reload();
										}
									}, 'json');
								},
								'取消' : function() {
									$(this).dialog("close");
								}
							}
						})
					} else {
						alert("获取服务器信息失败");
					}
				}, 'json');
			});

			//删除
			$(".deletebtn").live("click", function() {
				var dom = $(this);
				var sid = dom.parents('tr').attr("id");
				if(!confirm('您确定要删除该服务器吗？')){
					return false;
				}
				$.post('{:U("ServerEditor/dbDelete")}', {
					sid : sid
				}, function(data) {
					alert(data.info);
					if (data.status) {
						window.location.reload();
					}
				}, 'json');
			});

		});
	</script>
</body>
</html>